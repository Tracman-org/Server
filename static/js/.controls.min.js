$(function(){let o,t;$("#set-loc").click(function(){userid.length?navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){const t={ts:Date.now(),tok:token,alt:o.coords.altitude,lat:o.coords.latitude,lon:o.coords.longitude,spd:o.coords.speed||0};socket.emit("set",t),console.log("Set location:",t.lat+", "+t.lon)},function(o){alert("Unable to set location:",o.message)},{enableHighAccuracy:!0}):alert("Geolocation not enabled. "):alert("You are not logged in! ")}),$("#track-loc").click(function(){userid.length?navigator.geolocation?o?($("#track-loc").html('<i class="fa fa-crosshairs"></i>Track').prop("title","Click here to track your location. "),navigator.geolocation.clearWatch(o),o=void 0):navigator.geolocation?($("#track-loc").html('<i class="fa fa-crosshairs fa-spin"></i>Stop').prop("title","Click here to stop tracking your location. "),o=navigator.geolocation.watchPosition(function(o){t={ts:Date.now(),tok:token,lat:o.coords.latitude,lon:o.coords.longitude,alt:o.coords.altitude,spd:o.coords.speed||0},socket.emit("set",t),console.log("Set location:",t.lat+", "+t.lon)},function(t){alert("Unable to track location:",t.message),$("#track-loc").html('<i class="fa fa-crosshairs"></i>Track').prop("title","Click here to track your location. "),navigator.geolocation.clearWatch(o),o=void 0},{enableHighAccuracy:!0})):alert("Unable to track location. "):alert("Geolocation not enabled. "):alert("You are not logged in! ")}),$("#clear-loc").click(function(){userid.length?(o&&($("#track-loc").html('<i class="fa fa-crosshairs"></i>Track'),navigator.geolocation.clearWatch(o),o=void 0),socket.emit("set",{ts:Date.now(),tok:token,lat:0,lon:0,spd:0}),console.log("Cleared location")):alert("You are not logged in! ")})});